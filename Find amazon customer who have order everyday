Q) FIND THE AMAZON CUSTOMER WHO HAVE ATLEAST 1 IN YEAR 2023


USER_ID | ORDER_ID | ORDER_DATES
101     AA      20/12/2023
202     BB      14/10/2023
101     AA      15/10/2023

WITH CTE AS 
(SELECT * 
FROM AMAZON_TABLE WHERE YEAR(ORDER_DATE) = 2023)

CTE_2 AS 
(
SELECT 
USER_ID , COUNT(DISTINCT(ORDER_DATES) AS COUNT_DATES
FROM CTE
)

SELECT 
USER_ID 
FROM CTE_2 
WHERE COUNT_DATES = 365 ;
