Q) FIND THE AMAZON CUSTOMER WHO HAVE ATLEAST 1 ORDER EACH AND EVERY DAY IN LAST YEAR FROM TODAY


U_ID | O_ID | DATES
101     AA      20/12/2023
202     BB      14/10/2023
101     AA      15/10/2023

WITH CTE AS 
(SELECT * 
FROM AMAZON WHERE DATE BETWEEN CURRENT_DATE() AND CURRENT_DATE()-365)

, CTE_TWO AS (
SELECT U_ID , O_ID , COUNT(*) AS TOTAL_COUNT
FROM CTE GROUP BY 1,2)

SELECT 
ID 
FROM CTE_TWO 
WHERE TOTAL_COUNT >= 365 ;
