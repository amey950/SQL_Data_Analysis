Q) WRITE A CODE TO FIND OUT NUMBER WHICH HAS BEEN APPEARED 3 OR MORE THAN 3 TIMES CONSECUTIVELY.

ID | NUM |

THIS PROBLEM CAN BE SOLVED BY 2 METHODS:

METHOD 1:  BY USING LEAD FUNCTION

WITH CTE AS (SELECT NUM ,
LEAD(NUM,1) OVER() AS FIRST_LEAD,
LEAD(NUM,2) OVER() AS SECOND_LEAD
FROM TABLE)

SELECT 
DISTINCT(NUM) AS CONSECUTIVE_NUM
FROM CTE
WHERE NUM = FIRST_LEAD AND
NUM = SECOND_LEAD ;


METHOD 2 : THIS PROBLEM CAN ALSO BE SOLVED BY SELF JOINS

SELECT 
DISTINCT(T1.NUM) AS CONSECUTIVE_NUM             /* FETCHING DISTINCT NUMBERS */
FROM 
TABLE T1 JOIN TABLE T2 JOIN TABLE T3      /* 3 TABLES JOINED WITH ONE ANOTHER AS WE NEED 3 CONSECUTIVE NUMBERS */
ON T1.ID  = T2.ID-1
AND T2.ID = T3.ID-1
AND T1.NUM = T2.NUM AND T1.NUM = T3.NUM ;
