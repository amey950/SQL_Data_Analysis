Q) WRITE A CODE TO SEPARATE PRIME NUMBERS FROM THE TABLE CONTAINING VARIOUS NUMBERS

CREATE OR REPLACE TABLE VANS (ID NUMBER) ;
INSERT INTO VANS VALUES(5),(25),(37),(14),(11);                // CREATED TABLE AND INSERTED VALUES
-------------------------------------------------------------------------
WITH CTE (ID_1) AS (                                         // RECURSIVE CTE TO GET LIST OF ALL NUMBER FROM 2 TO MAX. OF NUMBER IN TABLE
SELECT 2 AS ID_1
UNION ALL
SELECT ID_1+1 
FROM CTE WHERE ID_1 < (SELECT MAX(ID) FROM VANS)),

CTEE AS (
SELECT * FROM VANS CROSS JOIN CTE                            // CROSS JOIN OF TABLE AND CTE AS WE ARE GOING TO DIVIDE 2 COLUMNS
WHERE VANS.ID <> CTE.ID_1 AND  ID > ID_1
),
CTE_3 AS (
SELECT *, ID%ID_1 AS REMAINDER FROM CTEE 
WHERE REMAINDER = 0                                      // IF REMAINDER IS 0 THEN IT IS COMPOSITE
ORDER BY ID,ID_1 ASC
)

SELECT ID FROM VANS WHERE  ID NOT IN  (SELECT DISTINCT(ID) FROM CTE_3) ;    // REMOVING COMPOSITE NUMBERS , SO WE WILL GET ONLY PRIME NUMBERS
