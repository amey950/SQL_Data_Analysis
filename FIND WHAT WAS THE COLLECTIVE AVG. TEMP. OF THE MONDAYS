


5)	WRITE A QUERY TO FIND WHAT WAS THE COLLECTIVE AVG. TEMP. OF THE MONDAYS.

WITH CTE AS 
(SELECT * 
FROM TABLE_TEMPERATURE 
WHERE DAYNAME(DATE) = ‘Mon’)

, CTE_2 AS 
(SELECT *, 
(MIN_TEMP + MAX_TEMP) / 2 AS AVG_TEMP 
FROM CTE),

CTE_3 AS 
(SELECT *, 
AVG(AVG_TEMP) AS OVERALL_AVG_TEMP
FROM CTE_2)

SELECT OVERALL_AVG_TEMP FROM CTE_3 ;
